<script>
  import { faqContent } from "./faqContent.js";
  let inputQuestion = "";
  let selectedAnswer = "";
  let showChat = false;

  function searchAnswer() {
    const foundFAQ = faqContent.find(faq =>
      faq.question.toLowerCase().includes(inputQuestion.toLowerCase())
    );
    selectedAnswer = foundFAQ ? foundFAQ.answer : "No matching question found. Feel free to join our discord to talk to a human.";
  }

  function toggleChat() {
    showChat = !showChat;
  }
</script>

<style>
  h2, p, h3 {
    color: white;
    font-family: 'barlow', sans-serif;
  }

  h2 {
    font-weight: bold;
  }

  .chat-container {
    position: fixed;
    bottom: 0;
    left: 0;
    margin: 16px;
    max-width: 320px;
    width: 100%;
    z-index: 999;
  }

  .toggle-button {
    background-color: #FF0000;
    border: none;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    font-size: 21px;
    height: 70px;
    width: 70px;
    margin-top: 0.5em;
    font-family: 'barlow', sans-serif;
  }

  .chat-content {
    background-color: black;
    border: 1px solid #F0EA3A;
    border-radius: 8px;
    display: none;
    margin-top: 8px;
    padding: 16px;
  }

  .chat-content.visible {
    display: block;
  }

  input[type="text"] {
    border: 1px solid #ced4da;
    border-radius: 4px;
    box-sizing: border-box;
    display: block;
    font-size: 14px;
    margin-bottom: 8px;
    padding: 6px 12px;
    width: 100%;
  }

  svg {
    margin-top: 0.5em;
  }

  a:hover {
    cursor: pointer;
  }



</style>

<div class="chat-container">
  
  <div class="chat-content {showChat ? 'visible' : ''}">
    <h2>Pyro Corporation Support</h2>
    <h3>Now accelerated with AI</h3>
    <input
      type="text"
      placeholder="Type your question"
      bind:value="{inputQuestion}"
      on:keydown="{e => (e.key === 'Enter' ? searchAnswer() : null)}"
    />
    <a on:click="{searchAnswer}"><svg width="227" height="70" viewBox="0 0 227 70" fill="none" xmlns="http://www.w3.org/2000/svg">
      <g clip-path="url(#clip0_10_43)">
      <mask id="mask0_10_43" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="0" y="0" width="227" height="70">
      <path d="M227 0H0V70H227V0Z" fill="white" fill-opacity="0.3"/>
      <path fill-rule="evenodd" clip-rule="evenodd" d="M1 27.2983V69H198.971L226 41.9706V1H27.2983L1 27.2983Z" fill="white" fill-opacity="0.3"/>
      </mask>
      <g mask="url(#mask0_10_43)">
      <path d="M1 27.2983L0.292893 26.5912L0 26.884V27.2983H1ZM1 69H0V70H1V69ZM198.971 69V70H199.385L199.678 69.7071L198.971 69ZM226 41.9706L226.707 42.6777L227 42.3848V41.9706H226ZM226 1H227V0H226V1ZM27.2983 1V0H26.884L26.5911 0.292893L27.2983 1ZM0 27.2983V69H2V27.2983H0ZM1 70H198.971V68H1V70ZM199.678 69.7071L226.707 42.6777L225.293 41.2635L198.263 68.2929L199.678 69.7071ZM227 41.9706V1H225V41.9706H227ZM226 0H27.2983V2H226V0ZM26.5911 0.292893L0.292893 26.5912L1.70711 28.0054L28.0054 1.70711L26.5911 0.292893Z" fill="white" fill-opacity="0.3"/>
      </g>
      <path fill-rule="evenodd" clip-rule="evenodd" d="M5.99999 21.4117V64H204H0.0289917L204 63.9706L220.971 47L221.161 47.1907V6H21.4117L5.99999 21.4117Z" fill="#FF0000"/>
      <path d="M77.6472 44.192C76.5432 44.192 75.5752 44 74.7432 43.616C73.9112 43.216 73.2632 42.664 72.7992 41.96C72.3512 41.24 72.1272 40.416 72.1272 39.488V38.864C72.1272 38.784 72.1512 38.72 72.1992 38.672C72.2632 38.608 72.3352 38.576 72.4152 38.576H75.1752C75.2552 38.576 75.3192 38.608 75.3672 38.672C75.4312 38.72 75.4632 38.784 75.4632 38.864V39.32C75.4632 39.88 75.6712 40.352 76.0872 40.736C76.5032 41.104 77.0632 41.288 77.7672 41.288C78.3912 41.288 78.8632 41.128 79.1832 40.808C79.5192 40.488 79.6872 40.08 79.6872 39.584C79.6872 39.216 79.5832 38.904 79.3752 38.648C79.1672 38.376 78.8712 38.128 78.4872 37.904C78.1192 37.664 77.5432 37.344 76.7592 36.944C75.7992 36.464 75.0152 36.016 74.4072 35.6C73.7992 35.184 73.2792 34.648 72.8472 33.992C72.4152 33.336 72.1992 32.544 72.1992 31.616C72.1992 30.688 72.4152 29.88 72.8472 29.192C73.2952 28.488 73.9192 27.952 74.7192 27.584C75.5192 27.2 76.4312 27.008 77.4552 27.008C78.5272 27.008 79.4792 27.216 80.3112 27.632C81.1432 28.032 81.7912 28.6 82.2552 29.336C82.7192 30.072 82.9512 30.92 82.9512 31.88V32.36C82.9512 32.44 82.9192 32.512 82.8552 32.576C82.8072 32.624 82.7432 32.648 82.6632 32.648H79.9032C79.8232 32.648 79.7512 32.624 79.6872 32.576C79.6392 32.512 79.6152 32.44 79.6152 32.36V31.928C79.6152 31.352 79.4152 30.872 79.0152 30.488C78.6152 30.104 78.0712 29.912 77.3832 29.912C76.8072 29.912 76.3512 30.064 76.0152 30.368C75.6952 30.656 75.5352 31.064 75.5352 31.592C75.5352 31.96 75.6312 32.28 75.8232 32.552C76.0152 32.824 76.3112 33.088 76.7112 33.344C77.1112 33.584 77.7192 33.904 78.5352 34.304L79.0392 34.592C79.9672 35.104 80.6872 35.552 81.1992 35.936C81.7272 36.304 82.1672 36.776 82.5192 37.352C82.8712 37.928 83.0472 38.624 83.0472 39.44C83.0472 40.896 82.5512 42.056 81.5592 42.92C80.5832 43.768 79.2792 44.192 77.6472 44.192ZM95.7565 29.816C95.7565 29.896 95.7245 29.968 95.6605 30.032C95.6125 30.08 95.5485 30.104 95.4685 30.104H89.0365C88.9565 30.104 88.9165 30.144 88.9165 30.224V33.968C88.9165 34.048 88.9565 34.088 89.0365 34.088H93.0445C93.1245 34.088 93.1885 34.12 93.2365 34.184C93.3005 34.232 93.3325 34.296 93.3325 34.376V36.704C93.3325 36.784 93.3005 36.856 93.2365 36.92C93.1885 36.968 93.1245 36.992 93.0445 36.992H89.0365C88.9565 36.992 88.9165 37.032 88.9165 37.112V40.976C88.9165 41.056 88.9565 41.096 89.0365 41.096H95.4685C95.5485 41.096 95.6125 41.128 95.6605 41.192C95.7245 41.24 95.7565 41.304 95.7565 41.384V43.712C95.7565 43.792 95.7245 43.864 95.6605 43.928C95.6125 43.976 95.5485 44 95.4685 44H85.8205C85.7405 44 85.6685 43.976 85.6045 43.928C85.5565 43.864 85.5325 43.792 85.5325 43.712V27.488C85.5325 27.408 85.5565 27.344 85.6045 27.296C85.6685 27.232 85.7405 27.2 85.8205 27.2H95.4685C95.5485 27.2 95.6125 27.232 95.6605 27.296C95.7245 27.344 95.7565 27.408 95.7565 27.488V29.816ZM107.338 44C107.162 44 107.05 43.92 107.002 43.76L106.45 41.408C106.434 41.344 106.394 41.312 106.33 41.312H101.842C101.778 41.312 101.738 41.344 101.722 41.408L101.17 43.76C101.122 43.92 101.018 44 100.858 44H97.9538C97.7458 44 97.6658 43.896 97.7138 43.688L102.034 27.44C102.082 27.28 102.194 27.2 102.37 27.2H105.85C106.026 27.2 106.138 27.28 106.186 27.44L110.506 43.688L110.53 43.784C110.53 43.928 110.442 44 110.266 44H107.338ZM102.37 38.552C102.354 38.6 102.362 38.64 102.394 38.672C102.426 38.688 102.458 38.696 102.49 38.696H105.658C105.69 38.696 105.722 38.688 105.754 38.672C105.786 38.64 105.794 38.6 105.778 38.552L104.122 31.592C104.106 31.528 104.082 31.496 104.05 31.496C104.018 31.496 103.994 31.528 103.978 31.592L102.37 38.552ZM120.685 44C120.509 44 120.397 43.92 120.349 43.76L117.925 37.136C117.893 37.072 117.853 37.04 117.805 37.04H116.293C116.213 37.04 116.173 37.08 116.173 37.16V43.712C116.173 43.792 116.141 43.864 116.077 43.928C116.029 43.976 115.965 44 115.885 44H113.077C112.997 44 112.925 43.976 112.861 43.928C112.813 43.864 112.789 43.792 112.789 43.712V27.488C112.789 27.408 112.813 27.344 112.861 27.296C112.925 27.232 112.997 27.2 113.077 27.2H118.933C119.877 27.2 120.717 27.416 121.453 27.848C122.189 28.264 122.757 28.856 123.157 29.624C123.557 30.392 123.757 31.272 123.757 32.264C123.757 33.288 123.533 34.176 123.085 34.928C122.637 35.68 122.005 36.24 121.189 36.608C121.109 36.64 121.085 36.696 121.117 36.776L123.853 43.664C123.869 43.696 123.877 43.736 123.877 43.784C123.877 43.928 123.789 44 123.613 44H120.685ZM116.293 30.104C116.213 30.104 116.173 30.144 116.173 30.224V34.328C116.173 34.408 116.213 34.448 116.293 34.448H118.381C118.973 34.448 119.453 34.256 119.821 33.872C120.189 33.472 120.373 32.944 120.373 32.288C120.373 31.616 120.189 31.088 119.821 30.704C119.453 30.304 118.973 30.104 118.381 30.104H116.293ZM131.509 44.192C130.421 44.192 129.461 43.976 128.629 43.544C127.797 43.112 127.149 42.496 126.685 41.696C126.237 40.896 126.013 39.968 126.013 38.912V32.24C126.013 31.2 126.237 30.288 126.685 29.504C127.149 28.704 127.797 28.088 128.629 27.656C129.461 27.224 130.421 27.008 131.509 27.008C132.597 27.008 133.557 27.224 134.389 27.656C135.221 28.072 135.861 28.664 136.309 29.432C136.773 30.2 137.005 31.096 137.005 32.12V32.24C137.005 32.32 136.973 32.392 136.909 32.456C136.861 32.52 136.797 32.552 136.717 32.552L133.909 32.672C133.717 32.672 133.621 32.584 133.621 32.408V32.096C133.621 31.44 133.429 30.912 133.045 30.512C132.661 30.112 132.149 29.912 131.509 29.912C130.869 29.912 130.357 30.112 129.973 30.512C129.589 30.912 129.397 31.44 129.397 32.096V39.128C129.397 39.784 129.589 40.312 129.973 40.712C130.357 41.096 130.869 41.288 131.509 41.288C132.149 41.288 132.661 41.096 133.045 40.712C133.429 40.312 133.621 39.784 133.621 39.128V38.816C133.621 38.64 133.717 38.552 133.909 38.552L136.717 38.672C136.797 38.672 136.861 38.704 136.909 38.768C136.973 38.816 137.005 38.88 137.005 38.96V39.032C137.005 40.056 136.773 40.96 136.309 41.744C135.861 42.528 135.221 43.136 134.389 43.568C133.557 43.984 132.597 44.192 131.509 44.192ZM147.112 27.488C147.112 27.408 147.136 27.344 147.184 27.296C147.248 27.232 147.32 27.2 147.4 27.2H150.208C150.288 27.2 150.352 27.232 150.4 27.296C150.464 27.344 150.496 27.408 150.496 27.488V43.712C150.496 43.792 150.464 43.864 150.4 43.928C150.352 43.976 150.288 44 150.208 44H147.4C147.32 44 147.248 43.976 147.184 43.928C147.136 43.864 147.112 43.792 147.112 43.712V37.136C147.112 37.056 147.072 37.016 146.992 37.016H143.152C143.072 37.016 143.032 37.056 143.032 37.136V43.712C143.032 43.792 143 43.864 142.936 43.928C142.888 43.976 142.824 44 142.744 44H139.936C139.856 44 139.784 43.976 139.72 43.928C139.672 43.864 139.648 43.792 139.648 43.712V27.488C139.648 27.408 139.672 27.344 139.72 27.296C139.784 27.232 139.856 27.2 139.936 27.2H142.744C142.824 27.2 142.888 27.232 142.936 27.296C143 27.344 143.032 27.408 143.032 27.488V33.968C143.032 34.048 143.072 34.088 143.152 34.088H146.992C147.072 34.088 147.112 34.048 147.112 33.968V27.488Z" fill="white"/>
      </g>
      <defs>
      <clipPath id="clip0_10_43">
      <rect width="227" height="70" fill="white"/>
      </clipPath>
      </defs>
      </svg>
    </a>
    <div>
      <p>{selectedAnswer}</p>
    </div>
  </div>
  <button class="toggle-button" on:click="{toggleChat}">{showChat ? 'x' : 'Help'}</button>
</div>